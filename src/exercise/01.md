# Composants ComposÃ©s
### ğŸ’¡ Comprendre le compound components pattern

## ğŸ“ Tes notes

Detaille ce que tu as appris ici `src/exercise/01.md`ouÂ surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Les composants composÃ©s sont des composants qui sont liÃ©s et fonctionnent ensembles pour crÃ©er une interface complÃ¨te.

```html
<div class="tab">
  <button class="tablinks" onclick="openCity(event, 'London')">London</button>
  <button class="tablinks" onclick="openCity(event, 'Paris')">Paris</button>
  <button class="tablinks" onclick="openCity(event, 'Tokyo')">Tokyo</button>
</div>

<!-- Tab content -->
<div id="London" class="tabcontent">
  <h3>London</h3>
  <p>London is the capital city of England.</p>
</div>

<div id="Paris" class="tabcontent">
  <h3>Paris</h3>
  <p>Paris is the capital of France.</p>
</div>

<div id="Tokyo" class="tabcontent">
  <h3>Tokyo</h3>
  <p>Tokyo is the capital of Japan.</p>
</div>
```

ğŸ“‘ Voir l'exemple sur [W3schools](https://www.w3schools.com/howto/howto_js_tabs.asp)

On pourrait alors crÃ©er un composant `<Tabs>` qui fonctionnerait comme cela 

```jsx
<Tabs
  tabs={[
    {title: 'London', display: 'London is the capital city of England.'},
    {title: 'Paris', display: 'Paris is the capital of France.'},
    {title: 'Tokyo', display: 'Tokyo is the capital of Japan.'},
  ]}
/>
```

Cela marcherait trÃ¨s bien mais c'est moins flexible qu'un composant composÃ©. Beaucoup de librairies utlise ce pattern ce qui permet une utilisation du type.

```jsx
<Tabs>
  <TabList>
    <Tab>Londre</Tab>
    <Tab>Paris</Tab>
    <Tab>Tokyo</Tab>
  </TabList>
  <TabPanels>
    <Panel>London is the capital city of England.</Panel>
    <Panel>Paris is the capital of France.</Panel>
    <Panel>Tokyo is the capital of Japan.</Panel>
  </TabPanels>
</Tabs>
```

## Exercice

Dans cet exercice nous avons un composant `CheckBox.` On souhaite que ce composant soit composÃ© (liÃ©/couplÃ©) Ã  deux autres composants.`<Accept>` et `<Decline>. De tel maniere que l'affichage` soit conditionner par la `checkbox`. 

```jsx
<CompoundComponentParent>
  <CheckBoxButton />
  <Accept>âœ… J'accepte les termes du contrat</Accept>
  <Decline>âŒ Je decline les termes du contrat</Decline>
</CompoundComponentParent>
```

## Bonus

### 1. ğŸš€ MÃªme exercice avec un composant Tab

Nous avons un composant `TabsComponant`.

```jsx
const options = [
    {title: 'London', display: 'London is the capital city of England.'},
    {title: 'Paris', display: 'Paris is the capital of France.'},
    {title: 'Tokyo', display: 'Tokyo is the capital of Japan.'},
  ]

<TabsComponant tabs={options} />
```

Dans cet exercice il va falloir faire un composant composÃ© pour gÃ©rer Ã©galement l'affichage d'autres composants liÃ©s Ã  `TabsComponant`. Par exemple des formulaires d'inscription. Lorsqu'un qu'un onglet est sÃ©lectionnÃ© (*Par exemple paris*) , le composant Paris est affichÃ©.

```jsx
<London>ğŸ’· Inscription pour aller Ã  Londre</London>
<Paris>ğŸ¥– Inscription pour aller Ã  Paris</Paris>
<Tokyo>ğŸ—» Inscription pour aller Ã  Tokyo</Tokyo>
```

### 2. ğŸš€ Tabs : Composant composÃ©s imbriquÃ©s

Dans l'exercice prÃ©cÃ©dent `TabsComponant` n'utilisait pas le pattern "Composant composÃ©s". Nous allons donc crÃ©er un composant composÃ©s qui gÃ¨re les `tabs` et un panel d'affichage dynamiquement de tel sorte que l'on puisse l'utiliser de la maniÃ¨re suivante.

```jsx
<Tabs>
	<TabList>
	  <Tab>Londre</Tab>
	  <Tab>Paris</Tab>
	  <Tab>Tokyo</Tab>
	</TabList>
	<TabPanels>
	  <Panel>ğŸ’· Inscription pour aller Ã  Londre</Panel>
	  <Panel>ğŸ¥– Inscription pour aller Ã  Paris</Panel>
	  <Panel>ğŸ—» Inscription pour aller Ã  Tokyo</Panel>
	</TabPanels>
 </Tabs>
```

ou avec d'autres Ã©lÃ©ments

```jsx
<Tabs>
	<TabList>
	  <Tab>Londre</Tab>
	  <Tab>Paris</Tab>
	  <Tab>Tokyo</Tab>
	  <Tab>New York</Tab>
	</TabList>
	<TabPanels>
	  <Panel>ğŸ’· Inscription pour aller Ã  Londre</Panel>
	  <Panel>ğŸ¥– Inscription pour aller Ã  Paris</Panel>
	  <Panel>ğŸ—» Inscription pour aller Ã  Tokyo</Panel>
	  <Panel>ğŸ—½ Inscription pour aller Ã  New York</Panel>
	</TabPanels>
 </Tabs>
```

On reconnait donc ici une donc une imbrication de composants composÃ©s.

- `Tabs` : qui gÃ¨re `TabList` et `TabPanels`
- `TabList` qui gÃ¨re les composants `Tab`
- `TabPanels` qui gÃ¨re les composants `Panel`

> *Nous allons rÃ©utiliser les mÃªmes feuilles de style en important `import '../tab.css'.`*

Dans cet exercice tu vas devoir implÃ©menter ce pattern. sur `Tabs`, `TabList` et `TabPanels.`

**A. Tabs :** 

Le point de dÃ©part est le composant `Tabs`. On clone les enfants avec les `props selectedTabId` et `selectTab`.

```jsx
function Tabs({children, ...props}) {
  const [selectedTabId, setSelectedTabId] = React.useState(0)
  const selectTab = id => setSelectedTabId(id)
  const clones = React.Children.map(children, child =>
    React.cloneElement(child, {
      selectedTabId: selectedTabId,
      selectTab: selectTab,
      ...props,
    }),
  )
  return (
    <div className="tabs" {...props}>
      {clones}
    </div>
  )
}
```

> Il faut remarquer le wrap avec une `<div className="tabs"` pour appliquer le style. mais il serait possible de le gÃ©rer via des `props className`.

**B. TabList :** 

`TabList` va se charger de cloner les composants `Tab`(les onglets). Pour fonctionner Tab aura besoin de savoir :

- L'onglet en cours : `tabId`
- Quel est l'onglet actif : `selectedTabId` pour afficher le bon `className`
    - `selectedTabId === tabId ? 'tablinks active' : 'tablinks'`
- la fonction Ã  appeler sur `onClick` de l'onglet `selectTab`

VoilÃ  Ã  quoi ressemble le composant `Tab`

```jsx
function Tab({selectedTabId, selectTab, tabId, children}) {
  return (
    <button
      key={children}
      className={selectedTabId === tabId ? 'tablinks active' : 'tablinks'}
      onClick={e => selectTab(tabId)}
    >
      {children}
    </button>
  )
}
```

Fais en sorte que TabList transmette tous ces props a Tab

```jsx
function TabList({children, selectedTabId, selectTab, ...props}) {
  const clones = ...
  // Clone ici
  // Pour determiner le tabId utilise l"index de array children
  // ğŸ¤–
  // (child, tabId) => 
  return (
    <div className="tab" {...props}>
      {clones}
    </div>
  )
}
```

**C. TabPanels :** 

Pour savoir si un panel doit s'afficher le composant `Panel` doit savoir :

- Quel est l'onglet actif : `selectedTabId`
- Quel est le panel en cours : `panelId`

> On utilisera le `className 'tabcontent'` pour le style. (transmit pas `TabPanels`)

Voila Ã  quoi ressemble Panel

```jsx
function Panel({selectedTabId, panelId, children, ...props}) {
  return selectedTabId === panelId ? <div {...props}>{children}</div> : null
}

```

Tu va maintenant devoir implÃ©menter 

```jsx
function TabPanels({selectedTabId, children}) {
  return React.Children.map(children, (child, panelId) =>
    // clones avec les props 
    // selectedTabId
    // className: 'tabcontent',
		// panelId
  )
}
```

### 3. ğŸš€ Supporter un enfant "autre"

On pourrait avoir envie d'avoir un enfant "autre" dans le composant composÃ©. Par exemple 

```jsx
<Tabs>
  <TabList>
    <Tab>Londre</Tab>
    <Tab>Paris</Tab>
    <Tab>Tokyo</Tab>
  </TabList>
  <TabPanels>
    <Panel>ğŸ’· Inscription pour aller Ã  Londre</Panel>
    <Panel>ğŸ¥– Inscription pour aller Ã  Paris</Panel>
    <Panel>ğŸ—» Inscription pour aller Ã  Tokyo</Panel>
  </TabPanels>
	<small> * Ceci est un autre composant</small>
</Tabs>
```

Si on ne modifie pas le code on obtient un warning 

> `Warning: React does not recognize the selectedTabId prop on a DOM element`

Pour gÃ©rer il suffit de tester le type de l'enfant 

```jsx
typeof child.type === 'string'
```

Si `typeof child.type === 'string'` return `child` sinon`React.CloneElement`

Ajoute ces conditions dans `Tabs`

## ğŸœ Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-react-avis).